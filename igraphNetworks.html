<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Ted Laderas (laderast@ohsu.edu)" />
  <meta name="date" content="2017-10-24" />
  <title>Network Analysis in R</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Network Analysis in R</h1>
  <p class="author">
Ted Laderas (<a href="mailto:laderast@ohsu.edu">laderast@ohsu.edu</a>)
  </p>
  <p class="date">October 24, 2017</p>
</div>
<div id="section-overview" class="slide section level2">
<h1>Overview</h1>
<ul>
<li>R Tools for Network Analysis
<ul>
<li>igraph</li>
<li>Rgraphviz</li>
<li>visNetwork</li>
</ul></li>
</ul>
</div>
<div id="section-network-data-representations-useful-in-r" class="slide section level2">
<h1>Network Data Representations useful in R</h1>
<ul>
<li><code>graphNEL</code> (node/edge list representation)
<ul>
<li>Easy to add/remove nodes and edges</li>
</ul></li>
<li><code>graphAM</code> (adjacency matrix)
<ul>
<li>Useful for permutations</li>
</ul></li>
<li><code>igraph</code> object (part of the igraph package)</li>
</ul>
</div>
<div id="section-the-igraph-package" class="slide section level2">
<h1>The igraph package</h1>
<ul>
<li>R, Python and C implementations</li>
<li>Build and modify networks by nodes and edges</li>
<li>Extract subgraphs given nodes
<ul>
<li>Clique Detection</li>
<li>Community Detection algorithms (graphlets, random walk, etc)</li>
</ul></li>
<li>Instantiate different background networks
<ul>
<li>Erdos-Renyi</li>
<li>Barabasi-Albert</li>
</ul></li>
<li>Network Metrics
<ul>
<li>Centrality (PageRank, Hub)</li>
<li>Isomorphic Relations (Motif Finding)</li>
</ul></li>
</ul>
</div>
<div id="section-what-you-need-to-run-these-slides" class="slide section level2">
<h1>What you need to run these slides</h1>
<p>I used the following libraries to generate these slides.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(igraph)
<span class="kw">require</span>(knitr)
<span class="kw">require</span>(visNetwork)
<span class="kw">require</span>(shiny)</code></pre></div>
</div>
<div id="section-loading-in-data-into-igraph" class="slide section level2">
<h1>Loading in Data into igraph</h1>
<p>The igraph package has parsers for reading in most of the general file formats for networks. Let’s load in the Karate network from <a href="http://www-personal.umich.edu/~mejn/netdata/">Network Example Data</a>. It’s in GML format, so we’ll need to specify that when we use <code>read_graph()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(igraph)
karate &lt;-<span class="st"> </span><span class="kw">read_graph</span>(<span class="st">&quot;data/karate.gml&quot;</span>, <span class="dt">format=</span><span class="st">&quot;gml&quot;</span>)
<span class="kw">class</span>(karate)</code></pre></div>
<pre><code>## [1] &quot;igraph&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.igraph</span>(karate)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-2-1.png" width="576" /></p>
</div>
<div id="section-adding-labels-and-improving-the-layout" class="slide section level2">
<h1>Adding Labels and Improving the Layout</h1>
<p>That’s not very informative, especially since the original data doesn’t have labels. Let’s add some:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get.vertex.attribute</span>(karate, <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
## [24] 24 25 26 27 28 29 30 31 32 33 34</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">karate &lt;-<span class="st"> </span><span class="kw">set.vertex.attribute</span>(karate, <span class="st">&quot;name&quot;</span>, 
                               <span class="dt">value=</span><span class="kw">c</span>(<span class="st">&quot;Chloe&quot;</span>, <span class="st">&quot;Emily&quot;</span>, <span class="st">&quot;Aaliyah&quot;</span>, <span class="st">&quot;Emma&quot;</span>, 
                                       <span class="st">&quot;Jennifer&quot;</span>, <span class="st">&quot;Olivia&quot;</span>, <span class="st">&quot;Hannah&quot;</span>,
                                       <span class="st">&quot;Jessica&quot;</span>, <span class="st">&quot;Sarah&quot;</span>, <span class="st">&quot;Lily&quot;</span>, <span class="st">&quot;Charlotte&quot;</span>, 
                                       <span class="st">&quot;Elizabeth&quot;</span>, <span class="st">&quot;Abigail&quot;</span>, <span class="st">&quot;Rebecca&quot;</span>,
                                       <span class="st">&quot;Samantha&quot;</span>, <span class="st">&quot;Jacob&quot;</span>, <span class="st">&quot;Muhammad&quot;</span>, <span class="st">&quot;Shawn&quot;</span>, 
                                        <span class="st">&quot;Aaron&quot;</span>, <span class="st">&quot;Daniel&quot;</span>, <span class="st">&quot;Jonah&quot;</span>, <span class="st">&quot;Alex&quot;</span>, 
                                       <span class="st">&quot;Michael&quot;</span>, <span class="st">&quot;James&quot;</span>, <span class="st">&quot;Ryan&quot;</span>, <span class="st">&quot;Jordan&quot;</span>, 
                                       <span class="st">&quot;Alexander&quot;</span>, <span class="st">&quot;Ali&quot;</span>, <span class="st">&quot;Tyler&quot;</span>, <span class="st">&quot;Kevin&quot;</span>, 
                                       <span class="st">&quot;Jack&quot;</span>, <span class="st">&quot;Ethan&quot;</span>, <span class="st">&quot;Luke&quot;</span>, <span class="st">&quot;Harry&quot;</span>))

<span class="co">#V() is a way to programmatically access vertices (or nodes) for igraph</span>
<span class="kw">V</span>(karate)</code></pre></div>
<pre><code>## + 34/34 vertices, named:
##  [1] Chloe     Emily     Aaliyah   Emma      Jennifer  Olivia    Hannah   
##  [8] Jessica   Sarah     Lily      Charlotte Elizabeth Abigail   Rebecca  
## [15] Samantha  Jacob     Muhammad  Shawn     Aaron     Daniel    Jonah    
## [22] Alex      Michael   James     Ryan      Jordan    Alexander Ali      
## [29] Tyler     Kevin     Jack      Ethan     Luke      Harry</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#get the ids (as a vector)</span>
<span class="kw">V</span>(karate)$name</code></pre></div>
<pre><code>##  [1] &quot;Chloe&quot;     &quot;Emily&quot;     &quot;Aaliyah&quot;   &quot;Emma&quot;      &quot;Jennifer&quot; 
##  [6] &quot;Olivia&quot;    &quot;Hannah&quot;    &quot;Jessica&quot;   &quot;Sarah&quot;     &quot;Lily&quot;     
## [11] &quot;Charlotte&quot; &quot;Elizabeth&quot; &quot;Abigail&quot;   &quot;Rebecca&quot;   &quot;Samantha&quot; 
## [16] &quot;Jacob&quot;     &quot;Muhammad&quot;  &quot;Shawn&quot;     &quot;Aaron&quot;     &quot;Daniel&quot;   
## [21] &quot;Jonah&quot;     &quot;Alex&quot;      &quot;Michael&quot;   &quot;James&quot;     &quot;Ryan&quot;     
## [26] &quot;Jordan&quot;    &quot;Alexander&quot; &quot;Ali&quot;       &quot;Tyler&quot;     &quot;Kevin&quot;    
## [31] &quot;Jack&quot;      &quot;Ethan&quot;     &quot;Luke&quot;      &quot;Harry&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#look at edges</span>
<span class="kw">E</span>(karate)</code></pre></div>
<pre><code>## + 78/78 edges (vertex names):
##  [1] Chloe   --Emily     Chloe   --Aaliyah   Emily   --Aaliyah  
##  [4] Chloe   --Emma      Emily   --Emma      Aaliyah --Emma     
##  [7] Chloe   --Jennifer  Chloe   --Olivia    Chloe   --Hannah   
## [10] Jennifer--Hannah    Olivia  --Hannah    Chloe   --Jessica  
## [13] Emily   --Jessica   Aaliyah --Jessica   Emma    --Jessica  
## [16] Chloe   --Sarah     Aaliyah --Sarah     Aaliyah --Lily     
## [19] Chloe   --Charlotte Jennifer--Charlotte Olivia  --Charlotte
## [22] Chloe   --Elizabeth Chloe   --Abigail   Emma    --Abigail  
## [25] Chloe   --Rebecca   Emily   --Rebecca   Aaliyah --Rebecca  
## [28] Emma    --Rebecca   Olivia  --Muhammad  Hannah  --Muhammad 
## + ... omitted several edges</code></pre>
</div>
<div id="section-a-more-informative-plot" class="slide section level2">
<h1>A More informative plot</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#layout example from https://rulesofreason.wordpress.com/2012/11/05/network-visualization-in-r-with-the-igraph-package/</span>
<span class="kw">plot.igraph</span>(karate, <span class="dt">layout=</span>layout.fruchterman.reingold, <span class="co"># the layout method. see the igraph documentation for details</span>
        <span class="dt">main=</span><span class="st">&#39;Karate Friends!&#39;</span>, <span class="co">#specifies the title</span>
        <span class="co">#vertex.label.dist=0.5,         #puts the name labels slightly off the dots</span>
        <span class="dt">vertex.label.color=</span><span class="st">&#39;black&#39;</span>,     <span class="co">#the color of the name labels</span>
        <span class="dt">vertex.label.font=</span><span class="dv">1</span>,            <span class="co">#the font of the name labels</span>
        <span class="dt">vertex.label=</span><span class="kw">V</span>(karate)$name,        <span class="co">#specifies the labels of the vertices. in this case the &#39;name&#39; attribute is used</span>
        <span class="dt">vertex.label.cex=</span><span class="fl">0.75</span>,          <span class="co">#specifies the size of the font of the labels. can also be made to vary</span>
        <span class="dt">vertex.size=</span><span class="kw">degree</span>(karate)*<span class="fl">1.5</span>, <span class="co">#make node size proportional to number of connections</span>
        <span class="dt">edge.arrow.size=</span><span class="dv">2</span>
)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-4-1.png" width="576" /></p>
</div>
<div id="section-graph-attributes" class="slide section level2">
<h1>Graph Attributes</h1>
<p>Each element of a graph (vertices and edges) can be customized by passing in the appropriate attribute. For more info, check out <a href="http://www.inside-r.org/packages/cran/igraph/docs/attributes" class="uri">http://www.inside-r.org/packages/cran/igraph/docs/attributes</a>.</p>
<p>Some properties are automatically mapped, such as <code>V(graph)$color</code> or <code>E(graph)$color</code>. If you add a new attribute, you’ll need to map this to a plotting property in <code>plot.igraph()</code></p>
<p>Remember, that after changing graph properties, such as node size, you need to run your <code>layout_</code> function again.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#setting node properties</span>
<span class="co">#can also use set.vertex.attributes() here</span>
newKarate &lt;-<span class="st"> </span>karate

faction &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, 
                     <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)
<span class="kw">V</span>(newKarate)$color &lt;-<span class="st"> </span>faction

<span class="co">#Set edge attributes using E(accessor)</span>
<span class="co">#can pass a named list for each node as well</span>
<span class="co">#You can also use set.edge.attributes() here</span>
<span class="kw">E</span>(newKarate)$color &lt;-<span class="st"> &quot;red&quot;</span>

<span class="co">#Here we instantiate a weight vector using sample</span>
weightvec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="kw">length</span>(<span class="kw">E</span>(newKarate)), <span class="dt">replace =</span> <span class="ot">TRUE</span>)
<span class="co">#Name each edge</span>
<span class="kw">names</span>(weightvec) &lt;-<span class="st"> </span><span class="kw">E</span>(newKarate)$name
weightvec</code></pre></div>
<pre><code>##  [1] 2 3 2 1 4 2 2 4 4 1 4 3 4 3 2 3 4 1 3 3 1 2 3 3 2 1 3 4 4 2 4 2 1 1 3
## [36] 2 1 3 2 3 4 4 3 4 4 3 4 4 3 3 4 3 1 3 4 2 4 2 3 4 3 2 4 2 1 2 2 1 2 1
## [71] 4 4 2 3 4 4 1 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">E</span>(newKarate)$weight &lt;-<span class="st"> </span>weightvec

<span class="co">#note we need to map an attribute to a property of the graph (igraph is dumb)</span>
<span class="kw">plot</span>(newKarate, <span class="dt">edge.width=</span><span class="kw">E</span>(karate)$weight)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-5-1.png" width="576" /></p>
</div>
<div id="section-simple-measures" class="slide section level2">
<h1>Simple Measures</h1>
<p>Degree Distribution and Average Path Length</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">degree</span>(karate)</code></pre></div>
<pre><code>##     Chloe     Emily   Aaliyah      Emma  Jennifer    Olivia    Hannah 
##        16         9        10         6         3         4         4 
##   Jessica     Sarah      Lily Charlotte Elizabeth   Abigail   Rebecca 
##         4         5         2         3         1         2         5 
##  Samantha     Jacob  Muhammad     Shawn     Aaron    Daniel     Jonah 
##         2         2         2         2         2         3         2 
##      Alex   Michael     James      Ryan    Jordan Alexander       Ali 
##         2         2         5         3         3         2         4 
##     Tyler     Kevin      Jack     Ethan      Luke     Harry 
##         3         4         4         6        12        17</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">degree</span>(karate), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##     Harry     Chloe      Luke   Aaliyah     Emily      Emma     Ethan 
##        17        16        12        10         9         6         6 
##     Sarah   Rebecca     James    Olivia    Hannah   Jessica       Ali 
##         5         5         5         4         4         4         4 
##     Kevin      Jack  Jennifer Charlotte    Daniel      Ryan    Jordan 
##         4         4         3         3         3         3         3 
##     Tyler      Lily   Abigail  Samantha     Jacob  Muhammad     Shawn 
##         3         2         2         2         2         2         2 
##     Aaron     Jonah      Alex   Michael Alexander Elizabeth 
##         2         2         2         2         2         1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">degree</span>(karate))</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-6-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">average.path.length</span>(karate)</code></pre></div>
<pre><code>## [1] 2.4082</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">shortPaths &lt;-<span class="st"> </span><span class="kw">get.shortest.paths</span>(karate, <span class="dt">from=</span><span class="st">&quot;Muhammad&quot;</span>)

<span class="kw">plot</span>(karate, <span class="dt">mark.groups=</span>shortPaths$vpath[<span class="kw">c</span>(<span class="dv">10</span>)])</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-7-1.png" width="576" /></p>
</div>
<div id="section-drunken-stumbling" class="slide section level2">
<h1>Drunken Stumbling</h1>
<p>Let’s generate a random walk from Jennifer and see where we get.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w &lt;-<span class="st"> </span><span class="kw">random_walk</span>(karate, <span class="dt">start =</span> <span class="st">&quot;Jennifer&quot;</span>, <span class="dt">steps =</span><span class="dv">1000</span>)

<span class="co">#who is the most visited?</span>
<span class="kw">sort</span>(<span class="kw">table</span>(w$name), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##     Harry     Chloe      Luke   Aaliyah     Emily     James     Ethan 
##       114       103        98        65        42        40        35 
##     Sarah      Emma     Kevin    Jordan    Olivia   Rebecca    Daniel 
##        32        31        28        27        25        23        22 
##    Hannah     Jonah  Samantha      Jack  Jennifer Charlotte   Jessica 
##        22        21        21        20        20        19        19 
##     Tyler   Abigail       Ali      Lily     Aaron   Michael      Ryan 
##        19        18        17        15        14        14        14 
## Alexander      Alex  Muhammad     Jacob     Shawn Elizabeth 
##        13        11        11        10        10         7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#normalize table by number of visits</span>
probKarate &lt;-<span class="st"> </span><span class="kw">table</span>(w$name)/<span class="dv">1000</span></code></pre></div>
</div>
<div id="section-influencers" class="slide section level2">
<h1>Influencers</h1>
<p>Who are the influencers (or hubs) in this social network? Let’s use some network centrality measures to see. Are there any differences?</p>
<p>Who gives the highest correlation with our drunken walk probabilities?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pr &lt;-<span class="st"> </span><span class="kw">page.rank</span>(karate)
<span class="kw">sort</span>(pr$vector, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##       Harry       Chloe        Luke     Aaliyah       Emily       Ethan 
## 0.100919182 0.096997285 0.071693226 0.057078509 0.052876924 0.037158087 
##        Emma       James       Sarah     Rebecca      Olivia      Hannah 
## 0.035859858 0.031522515 0.029766056 0.029536456 0.029111155 0.029111155 
##       Kevin         Ali        Jack     Jessica    Jennifer   Charlotte 
## 0.026288538 0.025639767 0.024590155 0.024490497 0.021977952 0.021977952 
##        Ryan      Jordan      Daniel       Tyler    Muhammad   Alexander 
## 0.021076034 0.021006197 0.019604636 0.019573459 0.016784005 0.015044038 
##     Abigail       Shawn        Alex    Samantha       Jacob       Aaron 
## 0.014644892 0.014558677 0.014558677 0.014535994 0.014535994 0.014535994 
##       Jonah     Michael        Lily   Elizabeth 
## 0.014535994 0.014535994 0.014309397 0.009564745</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nk &lt;-<span class="st"> </span><span class="kw">V</span>(karate)$name
<span class="kw">cor</span>(pr$vector[nk], probKarate[nk])</code></pre></div>
<pre><code>## [1] 0.9713167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ec &lt;-<span class="st"> </span><span class="kw">eigen_centrality</span>(karate)
<span class="kw">sort</span>(ec$vector, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##      Harry      Chloe    Aaliyah       Luke      Emily      Sarah 
## 1.00000000 0.95213237 0.84955420 0.82665886 0.71233514 0.60906844 
##    Rebecca       Emma      Ethan       Jack    Jessica      James 
## 0.60657439 0.56561431 0.51165649 0.46806481 0.45789093 0.40207086 
##     Daniel      Kevin        Ali      Tyler       Lily      Jacob 
## 0.39616224 0.36147301 0.35749923 0.35107297 0.27499812 0.27159396 
##      Aaron   Samantha      Jonah    Michael      Shawn       Alex 
## 0.27159396 0.27159396 0.27159396 0.27159396 0.24747879 0.24747879 
##    Abigail     Hannah     Olivia   Jennifer  Charlotte  Alexander 
## 0.22566382 0.21288383 0.21288383 0.20347148 0.20347148 0.20242852 
##     Jordan       Ryan  Elizabeth   Muhammad 
## 0.15857597 0.15280670 0.14156633 0.06330461</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(ec$vector[nk], probKarate[nk])</code></pre></div>
<pre><code>## [1] 0.87063</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hs &lt;-<span class="st"> </span><span class="kw">hub_score</span>(karate)
<span class="kw">sort</span>(hs$vector, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##      Harry      Chloe    Aaliyah       Luke      Emily      Sarah 
## 1.00000000 0.95213237 0.84955420 0.82665886 0.71233514 0.60906844 
##    Rebecca       Emma      Ethan       Jack    Jessica      James 
## 0.60657439 0.56561431 0.51165649 0.46806481 0.45789093 0.40207086 
##     Daniel      Kevin        Ali      Tyler       Lily   Samantha 
## 0.39616224 0.36147301 0.35749923 0.35107297 0.27499812 0.27159396 
##      Jacob      Aaron      Jonah    Michael      Shawn       Alex 
## 0.27159396 0.27159396 0.27159396 0.27159396 0.24747879 0.24747879 
##    Abigail     Olivia     Hannah   Jennifer  Charlotte  Alexander 
## 0.22566382 0.21288383 0.21288383 0.20347148 0.20347148 0.20242852 
##     Jordan       Ryan  Elizabeth   Muhammad 
## 0.15857597 0.15280670 0.14156633 0.06330461</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(hs$vector[nk], probKarate[nk])</code></pre></div>
<pre><code>## [1] 0.87063</code></pre>
</div>
<div id="section-cliques" class="slide section level2">
<h1>Cliques?</h1>
<p>Who’s the most connected groups to each other? Enquiring minds want to know…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##get all cliques in the data
karateCliques &lt;-<span class="st"> </span><span class="kw">cliques</span>(karate)
<span class="kw">length</span>(karateCliques)</code></pre></div>
<pre><code>## [1] 170</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#let&#39;s try finding the largest cliques</span>
largeKarateCliques &lt;-<span class="st"> </span><span class="kw">largest_cliques</span>(karate)
largeKarateCliques</code></pre></div>
<pre><code>## [[1]]
## + 5/34 vertices, named:
## [1] Jessica Chloe   Emily   Aaliyah Emma   
## 
## [[2]]
## + 5/34 vertices, named:
## [1] Emma    Chloe   Emily   Aaliyah Rebecca</code></pre>
</div>
<div id="section-what-are-the-karate-communities" class="slide section level2">
<h1>What are the Karate communities?</h1>
<p>Can we split the network up into smaller communities? There are number of community detection algorithms we can use to see if we can cleanly separate our network into smaller modules, or communities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Segment the karate network using the fast-greedy algorithm
fgComm &lt;-<span class="st"> </span><span class="kw">fastgreedy.community</span>(karate)
<span class="kw">plot</span>(fgComm, karate)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-11-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Segment the karate network using the walktrap algorithm
wkComm &lt;-<span class="st"> </span><span class="kw">walktrap.community</span>(karate)
<span class="kw">plot</span>(wkComm, karate)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-11-2.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##how close are the algorithms?
<span class="kw">compare</span>(<span class="kw">membership</span>(fgComm), <span class="kw">membership</span>(wkComm))</code></pre></div>
<pre><code>## [1] 1.14204</code></pre>
</div>
<div id="section-extracting-subgraphs-from-community-membership" class="slide section level2">
<h1>Extracting subgraphs from community membership</h1>
<p>If there is a community of interest, we can use <code>induced.subgraph</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##extract the membership vector for the fastgreedy community
fgCommMembers &lt;-<span class="st"> </span><span class="kw">membership</span>(fgComm)

##let&#39;s extract the one of the cliques
clique1 &lt;-<span class="st"> </span><span class="kw">induced.subgraph</span>(karate, <span class="dt">v=</span>largeKarateCliques[[<span class="dv">1</span>]]$name)
<span class="kw">plot</span>(clique1)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-12-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#how many different communities are there?</span>
<span class="kw">levels</span>(<span class="kw">factor</span>(fgCommMembers))</code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">comm1 &lt;-<span class="st"> </span><span class="kw">induced.subgraph</span>(karate, fgCommMembers ==<span class="st"> </span><span class="dv">1</span>)
<span class="kw">plot</span>(comm1)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-12-2.png" width="576" /></p>
</div>
<div id="section-other-searches" class="slide section level2">
<h1>Other searches</h1>
<p>How do we find all of Emma’s friends?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emmasNeighbors &lt;-<span class="st"> </span><span class="kw">neighbors</span>(karate, <span class="dt">v=</span><span class="st">&quot;Emma&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;all&quot;</span>)
emmaSubnet &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Emma&quot;</span>,emmasNeighbors$name)
emmaSubnet</code></pre></div>
<pre><code>## [1] &quot;Emma&quot;    &quot;Chloe&quot;   &quot;Emily&quot;   &quot;Aaliyah&quot; &quot;Jessica&quot; &quot;Abigail&quot; &quot;Rebecca&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emmaSubgraph &lt;-<span class="st"> </span><span class="kw">induced.subgraph</span>(karate, emmaSubnet)
<span class="kw">plot</span>(emmaSubgraph)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-13-1.png" width="576" /></p>
</div>
<div id="section-other-plot-layouts" class="slide section level2">
<h1>Other Plot Layouts</h1>
<p>igraph’s built in plotting is not super customizable, but you can change layouts. All of the different igraph layouts begin with “layout_”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#circle plot</span>
<span class="kw">plot</span>(karate, <span class="dt">layout=</span>layout_in_circle)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-14-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#layout plot on grid</span>
<span class="kw">plot</span>(karate, <span class="dt">layout=</span>layout_on_grid)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-14-2.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#force-directed layout for large graphs</span>
<span class="kw">plot</span>(karate, <span class="dt">layout=</span>layout_with_lgl)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-14-3.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#layout plot with center (star layout)</span>
<span class="kw">plot</span>(karate, <span class="dt">layout=</span>layout_as_star)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-14-4.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#layout plot on grid</span>
<span class="kw">plot</span>(karate, <span class="dt">layout=</span>layout_with_dh)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-14-5.png" width="576" /></p>
</div>
<div id="section-generating-graphs-from-scratch" class="slide section level2">
<h1>Generating graphs from scratch</h1>
<p>Oftentimes, you will need to generate a bunch of graphs from scratch, for a background distribution. There are some built in functions to do that.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Random Graphs</span>

rgGraph &lt;-<span class="st"> </span><span class="kw">random.graph.game</span>(<span class="dv">34</span>, <span class="dt">p.or.m =</span> <span class="fl">0.2</span>)
<span class="kw">plot</span>(rgGraph)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-15-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">degree</span>(rgGraph))</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-15-2.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Erdos Renyi Graphs</span>
erGraph &lt;-<span class="st"> </span><span class="kw">erdos.renyi.game</span>(<span class="dv">34</span>, <span class="fl">0.1</span>)
<span class="kw">plot</span>(erGraph)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-16-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">degree</span>(erGraph))</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-16-2.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Barabasi graphs - power law distributed</span>
bgGraph &lt;-<span class="st"> </span><span class="kw">barabasi.game</span>(<span class="dv">34</span>, <span class="dv">1</span>)
<span class="kw">plot</span>(bgGraph)</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-17-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Confirm edge distribution is correct</span>
<span class="kw">hist</span>(<span class="kw">degree</span>(bgGraph))</code></pre></div>
<p><img src="igraphNetworks_files/figure-slidy/unnamed-chunk-17-2.png" width="576" /></p>
</div>
<div id="section-converting-igraph-objects-to-other-representations" class="slide section level2">
<h1>Converting igraph Objects to Other Representations</h1>
<p>The graph package (not the igraph package!) contains the graphNEL and graphAM representations. I don’t really go into using them here, but just know that you can convert back and forth from these different representations using different commands.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(graph)</code></pre></div>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: &#39;BiocGenerics&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:parallel&#39;:
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following objects are masked from &#39;package:igraph&#39;:
## 
##     normalize, union</code></pre>
<pre><code>## The following object is masked from &#39;package:gridExtra&#39;:
## 
##     combine</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     IQR, mad, xtabs</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     anyDuplicated, append, as.data.frame, cbind, colnames,
##     do.call, duplicated, eval, evalq, Filter, Find, get, grep,
##     grepl, intersect, is.unsorted, lapply, lengths, Map, mapply,
##     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
##     Position, rank, rbind, Reduce, rownames, sapply, setdiff,
##     sort, table, tapply, union, unique, unsplit, which, which.max,
##     which.min</code></pre>
<pre><code>## 
## Attaching package: &#39;graph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:igraph&#39;:
## 
##     degree, edges, intersection</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#graphNEL objects</span>
karateGN &lt;-<span class="st"> </span><span class="kw">igraph.to.graphNEL</span>(karate)
karateGN</code></pre></div>
<pre><code>## A graphNEL graph with undirected edges
## Number of Nodes = 34 
## Number of Edges = 78</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Adjacency matrix</span>
karateAM &lt;-<span class="st"> </span><span class="kw">as</span>(karateGN, <span class="st">&quot;graphAM&quot;</span>)
karateAM</code></pre></div>
<pre><code>## A graphAM graph with undirected edges
## Number of Nodes = 34 
## Number of Edges = 78</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#look at the actual adjacency matrix</span>
karateAdjMat &lt;-<span class="st"> </span>karateAM@adjMat
<span class="kw">rownames</span>(karateAdjMat) &lt;-<span class="st"> </span><span class="kw">colnames</span>(karateAdjMat)
<span class="kw">rowSums</span>(karateAdjMat)</code></pre></div>
<pre><code>##     Chloe     Emily   Aaliyah      Emma  Jennifer    Olivia    Hannah 
##        16         9        10         6         3         4         4 
##   Jessica     Sarah      Lily Charlotte Elizabeth   Abigail   Rebecca 
##         4         5         2         3         1         2         5 
##  Samantha     Jacob  Muhammad     Shawn     Aaron    Daniel     Jonah 
##         2         2         2         2         2         3         2 
##      Alex   Michael     James      Ryan    Jordan Alexander       Ali 
##         2         2         5         3         3         2         4 
##     Tyler     Kevin      Jack     Ethan      Luke     Harry 
##         3         4         4         6        12        17</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(karateAdjMat)</code></pre></div>
<pre><code>##     Chloe     Emily   Aaliyah      Emma  Jennifer    Olivia    Hannah 
##        16         9        10         6         3         4         4 
##   Jessica     Sarah      Lily Charlotte Elizabeth   Abigail   Rebecca 
##         4         5         2         3         1         2         5 
##  Samantha     Jacob  Muhammad     Shawn     Aaron    Daniel     Jonah 
##         2         2         2         2         2         3         2 
##      Alex   Michael     James      Ryan    Jordan Alexander       Ali 
##         2         2         5         3         3         2         4 
##     Tyler     Kevin      Jack     Ethan      Luke     Harry 
##         3         4         4         6        12        17</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">karateAdjMat</code></pre></div>
<pre><code>##           Chloe Emily Aaliyah Emma Jennifer Olivia Hannah Jessica Sarah
## Chloe         0     1       1    1        1      1      1       1     1
## Emily         1     0       1    1        0      0      0       1     0
## Aaliyah       1     1       0    1        0      0      0       1     1
## Emma          1     1       1    0        0      0      0       1     0
## Jennifer      1     0       0    0        0      0      1       0     0
## Olivia        1     0       0    0        0      0      1       0     0
## Hannah        1     0       0    0        1      1      0       0     0
## Jessica       1     1       1    1        0      0      0       0     0
## Sarah         1     0       1    0        0      0      0       0     0
## Lily          0     0       1    0        0      0      0       0     0
## Charlotte     1     0       0    0        1      1      0       0     0
## Elizabeth     1     0       0    0        0      0      0       0     0
## Abigail       1     0       0    1        0      0      0       0     0
## Rebecca       1     1       1    1        0      0      0       0     0
## Samantha      0     0       0    0        0      0      0       0     0
## Jacob         0     0       0    0        0      0      0       0     0
## Muhammad      0     0       0    0        0      1      1       0     0
## Shawn         1     1       0    0        0      0      0       0     0
## Aaron         0     0       0    0        0      0      0       0     0
## Daniel        1     1       0    0        0      0      0       0     0
## Jonah         0     0       0    0        0      0      0       0     0
## Alex          1     1       0    0        0      0      0       0     0
## Michael       0     0       0    0        0      0      0       0     0
## James         0     0       0    0        0      0      0       0     0
## Ryan          0     0       0    0        0      0      0       0     0
## Jordan        0     0       0    0        0      0      0       0     0
## Alexander     0     0       0    0        0      0      0       0     0
## Ali           0     0       1    0        0      0      0       0     0
## Tyler         0     0       1    0        0      0      0       0     0
## Kevin         0     0       0    0        0      0      0       0     0
## Jack          0     1       0    0        0      0      0       0     1
## Ethan         1     0       0    0        0      0      0       0     0
## Luke          0     0       1    0        0      0      0       0     1
## Harry         0     0       0    0        0      0      0       0     1
##           Lily Charlotte Elizabeth Abigail Rebecca Samantha Jacob Muhammad
## Chloe        0         1         1       1       1        0     0        0
## Emily        0         0         0       0       1        0     0        0
## Aaliyah      1         0         0       0       1        0     0        0
## Emma         0         0         0       1       1        0     0        0
## Jennifer     0         1         0       0       0        0     0        0
## Olivia       0         1         0       0       0        0     0        1
## Hannah       0         0         0       0       0        0     0        1
## Jessica      0         0         0       0       0        0     0        0
## Sarah        0         0         0       0       0        0     0        0
## Lily         0         0         0       0       0        0     0        0
## Charlotte    0         0         0       0       0        0     0        0
## Elizabeth    0         0         0       0       0        0     0        0
## Abigail      0         0         0       0       0        0     0        0
## Rebecca      0         0         0       0       0        0     0        0
## Samantha     0         0         0       0       0        0     0        0
## Jacob        0         0         0       0       0        0     0        0
## Muhammad     0         0         0       0       0        0     0        0
## Shawn        0         0         0       0       0        0     0        0
## Aaron        0         0         0       0       0        0     0        0
## Daniel       0         0         0       0       0        0     0        0
## Jonah        0         0         0       0       0        0     0        0
## Alex         0         0         0       0       0        0     0        0
## Michael      0         0         0       0       0        0     0        0
## James        0         0         0       0       0        0     0        0
## Ryan         0         0         0       0       0        0     0        0
## Jordan       0         0         0       0       0        0     0        0
## Alexander    0         0         0       0       0        0     0        0
## Ali          0         0         0       0       0        0     0        0
## Tyler        0         0         0       0       0        0     0        0
## Kevin        0         0         0       0       0        0     0        0
## Jack         0         0         0       0       0        0     0        0
## Ethan        0         0         0       0       0        0     0        0
## Luke         0         0         0       0       0        1     1        0
## Harry        1         0         0       0       1        1     1        0
##           Shawn Aaron Daniel Jonah Alex Michael James Ryan Jordan
## Chloe         1     0      1     0    1       0     0    0      0
## Emily         1     0      1     0    1       0     0    0      0
## Aaliyah       0     0      0     0    0       0     0    0      0
## Emma          0     0      0     0    0       0     0    0      0
## Jennifer      0     0      0     0    0       0     0    0      0
## Olivia        0     0      0     0    0       0     0    0      0
## Hannah        0     0      0     0    0       0     0    0      0
## Jessica       0     0      0     0    0       0     0    0      0
## Sarah         0     0      0     0    0       0     0    0      0
## Lily          0     0      0     0    0       0     0    0      0
## Charlotte     0     0      0     0    0       0     0    0      0
## Elizabeth     0     0      0     0    0       0     0    0      0
## Abigail       0     0      0     0    0       0     0    0      0
## Rebecca       0     0      0     0    0       0     0    0      0
## Samantha      0     0      0     0    0       0     0    0      0
## Jacob         0     0      0     0    0       0     0    0      0
## Muhammad      0     0      0     0    0       0     0    0      0
## Shawn         0     0      0     0    0       0     0    0      0
## Aaron         0     0      0     0    0       0     0    0      0
## Daniel        0     0      0     0    0       0     0    0      0
## Jonah         0     0      0     0    0       0     0    0      0
## Alex          0     0      0     0    0       0     0    0      0
## Michael       0     0      0     0    0       0     0    0      0
## James         0     0      0     0    0       0     0    0      1
## Ryan          0     0      0     0    0       0     0    0      1
## Jordan        0     0      0     0    0       0     1    1      0
## Alexander     0     0      0     0    0       0     0    0      0
## Ali           0     0      0     0    0       0     1    1      0
## Tyler         0     0      0     0    0       0     0    0      0
## Kevin         0     0      0     0    0       0     1    0      0
## Jack          0     0      0     0    0       0     0    0      0
## Ethan         0     0      0     0    0       0     0    1      1
## Luke          0     1      0     1    0       1     1    0      0
## Harry         0     1      1     1    0       1     1    0      0
##           Alexander Ali Tyler Kevin Jack Ethan Luke Harry
## Chloe             0   0     0     0    0     1    0     0
## Emily             0   0     0     0    1     0    0     0
## Aaliyah           0   1     1     0    0     0    1     0
## Emma              0   0     0     0    0     0    0     0
## Jennifer          0   0     0     0    0     0    0     0
## Olivia            0   0     0     0    0     0    0     0
## Hannah            0   0     0     0    0     0    0     0
## Jessica           0   0     0     0    0     0    0     0
## Sarah             0   0     0     0    1     0    1     1
## Lily              0   0     0     0    0     0    0     1
## Charlotte         0   0     0     0    0     0    0     0
## Elizabeth         0   0     0     0    0     0    0     0
## Abigail           0   0     0     0    0     0    0     0
## Rebecca           0   0     0     0    0     0    0     1
## Samantha          0   0     0     0    0     0    1     1
## Jacob             0   0     0     0    0     0    1     1
## Muhammad          0   0     0     0    0     0    0     0
## Shawn             0   0     0     0    0     0    0     0
## Aaron             0   0     0     0    0     0    1     1
## Daniel            0   0     0     0    0     0    0     1
## Jonah             0   0     0     0    0     0    1     1
## Alex              0   0     0     0    0     0    0     0
## Michael           0   0     0     0    0     0    1     1
## James             0   1     0     1    0     0    1     1
## Ryan              0   1     0     0    0     1    0     0
## Jordan            0   0     0     0    0     1    0     0
## Alexander         0   0     0     1    0     0    0     1
## Ali               0   0     0     0    0     0    0     1
## Tyler             0   0     0     0    0     1    0     1
## Kevin             1   0     0     0    0     0    1     1
## Jack              0   0     0     0    0     0    1     1
## Ethan             0   0     1     0    0     0    1     1
## Luke              0   0     0     1    1     1    0     1
## Harry             1   1     1     1    1     1    1     0</code></pre>
</div>
<div id="section-exporting-out-graphs" class="slide section level2">
<h1>Exporting out graphs</h1>
<p>Sometimes you want to take your subgraphs and use a program like Cytoscape to make the visualization prettier.</p>
<p>Writing to GML format will preserve most of your information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_graph</span>(karate, <span class="dt">file=</span><span class="st">&quot;karate2.gml&quot;</span>, <span class="dt">format=</span><span class="st">&quot;gml&quot;</span>)</code></pre></div>
<p>Lots of other output options, including:</p>
<ul>
<li>GraphML</li>
<li>EdgeList</li>
<li>LGL</li>
</ul>
</div>
<div id="section-cyrest-api" class="slide section level2">
<h1>cyREST API</h1>
<p>The cyREST API allows you to programatically transfer network data into Cytoscape. It’s a bit quirky to set up and use, but once you set it up, you can transfer all network attributes (edge, node, and graph) that you’ve assigned to your GraphNEL objects directly into Cytoscape.</p>
<p>For more info, check this link out: <a href="https://github.com/idekerlab/cy-rest-R" class="uri">https://github.com/idekerlab/cy-rest-R</a></p>
</div>
<div id="section-rgraphviz" class="slide section level2">
<h1>Rgraphviz</h1>
<ul>
<li>Graphviz: mature package for network and graph visualization (AT&amp;T)</li>
<li>Can define custom node graphics using viewports</li>
<li>Multiple Layouts
<ul>
<li>dot (hierarchical)</li>
<li>neato (force-directed, spring-model)</li>
<li>twopi (radial plots)</li>
<li>circo (circular graphs)</li>
</ul></li>
<li>Clusters (subgraphs) for more control over the layout</li>
</ul>
</div>
<div id="section-custom-node-graphics-kegggraph-cluster-layout-in-rgraphviz" class="slide section level2">
<h1>Custom Node Graphics + KEGGgraph + cluster layout in <code>Rgraphviz</code></h1>
<p>I used a combination of <code>ggplot2</code> and <code>Rgraphviz</code> to plot time-series data on a pathway defined by KEGG. To get this to work, I had to define some clusters in the graph layout.</p>
<p><img src="figures/BT474-mtor-test.png" alt="mTOR-pathway-Rgraphviz" style="width: 800px;"/></p>
</div>
<div id="section-drawbacks-to-rgraphviz" class="slide section level2">
<h1>Drawbacks to <code>Rgraphviz</code></h1>
<p><code>Graphviz</code> is not guaranteed to give you the best layout - it can take a lot of customization and specification of clusters. You may want to take your networks into a tool such as Cytoscape that will let you customize your graph much more.</p>
<p>More info on customizing graph layout for Rgraphviz here: <a href="https://bioconductor.org/packages/release/bioc/vignettes/biocGraph/inst/doc/layingOutPathways.pdf" class="uri">https://bioconductor.org/packages/release/bioc/vignettes/biocGraph/inst/doc/layingOutPathways.pdf</a></p>
</div>
<div id="section-visnetwork" class="slide section level2">
<h1><code>visNetwork</code></h1>
<p>Make interactive networks with <code>visNetwork</code> and <code>shiny</code>!</p>
<p>Why would you want to do this? Exploratory Data Analysis of the Network.</p>
<p><div class="form-group shiny-input-container">
<label class="control-label" for="slide_me">Try Sliding Me</label>
<input class="js-range-slider" id="slide_me" data-type="double" data-min="1" data-max="17" data-from="1" data-to="17" data-step="1" data-grid="true" data-grid-num="8" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-keyboard-step="6.25" data-drag-interval="true" data-data-type="number"/>
</div><div id="network" style="width:600px; height:500px; " class="visNetwork html-widget html-widget-output"></div></p>
</div>
<div id="section-visnetwork-objects-and-igraph-objects" class="slide section level2">
<h1><code>visNetwork</code> objects and <code>igraph</code> objects</h1>
<p>I used <code>toVisNetworkData()</code> to convert my <code>igraph</code> <code>karate</code> object to a visNetwork object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kInt &lt;-<span class="st"> </span><span class="kw">toVisNetworkData</span>(karate)

<span class="co">#need to relabel nodes data.frame</span>
nodes &lt;-<span class="st"> </span>kInt$nodes
nodes$label &lt;-<span class="st"> </span><span class="kw">rownames</span>(nodes)
nodes$id &lt;-<span class="st"> </span><span class="kw">rownames</span>(nodes)

edges &lt;-<span class="st"> </span>kInt$edges

<span class="kw">visNetwork</span>(nodes, edges, <span class="dt">height=</span><span class="st">&quot;600px&quot;</span>, <span class="dt">width=</span><span class="st">&quot;100%&quot;</span>) </code></pre></div>
</div>
<div id="section-download-this-tutorial" class="slide section level2">
<h1>Download this Tutorial</h1>
<p><a href="https://github.com/laderast/igraphTutorial">github.com/laderast/igraphTutorial/</a></p>
</div>
<div id="section-sessioninfo" class="slide section level2">
<h1>SessionInfo</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.3.3 (2017-03-06)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: macOS Sierra 10.12.6
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
## [1] graph_1.52.0        BiocGenerics_0.20.0 visNetwork_2.0.1   
## [4] knitr_1.17          igraph_1.0.1        gridExtra_2.3      
## [7] learnr_0.9          shiny_1.0.5        
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.12    magrittr_1.5    xtable_1.8-2    R6_2.2.2       
##  [5] stringr_1.2.0   tools_3.3.3     grid_3.3.3      gtable_0.2.0   
##  [9] withr_2.0.0     htmltools_0.3.6 yaml_2.1.14     rprojroot_1.2  
## [13] digest_0.6.12   htmlwidgets_0.9 evaluate_0.10.1 mime_0.5       
## [17] rmarkdown_1.6   stringi_1.1.5   backports_1.0.5 stats4_3.3.3   
## [21] jsonlite_1.5    httpuv_1.3.5    markdown_0.8</code></pre>

<script type="application/shiny-prerendered" data-context="server-start">
#knitr::opts_chunk$set(echo = )
library(learnr)
library(gridExtra)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
library(igraph)
karate <- read_graph("data/karate.gml", format="gml")

karate <- set.vertex.attribute(karate, "name", 
                               value=c("Chloe", "Emily", "Aaliyah", "Emma", 
                                       "Jennifer", "Olivia", "Hannah",
                                       "Jessica", "Sarah", "Lily", "Charlotte", 
                                       "Elizabeth", "Abigail", "Rebecca",
                                       "Samantha", "Jacob", "Muhammad", "Shawn", 
                                        "Aaron", "Daniel", "Jonah", "Alex", 
                                       "Michael", "James", "Ryan", "Jordan", 
                                       "Alexander", "Ali", "Tyler", "Kevin", 
                                       "Jack", "Ethan", "Luke", "Harry"))

deg <- igraph::degree(karate)

kInt <- toVisNetworkData(karate)
    
nodes <- kInt$nodes
nodes$label <- rownames(nodes)
nodes$id <- rownames(nodes)

edges <- kInt$edges

  output$network <- renderVisNetwork({
    # minimal example
    visNetwork(nodes, edges, height="600px", width="100%") %>%
      visOptions(highlightNearest = TRUE) %>%
      visInteraction(navigationButtons = TRUE)
  })
  
observe({
  nodes_selection <- names(deg[deg >= min(input$slide_me) & deg <= max(input$slide_me)])
  print(names(nodes_selection))
  print(nodes_selection)
  visNetworkProxy("network") %>%
    visSelectNodes(id = nodes_selection,highlightEdges = TRUE,clickEvent = TRUE)
})
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap-3.3.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["slidy"]},{"type":"character","attributes":{},"value":["2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/slidy/Slidy2"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["scripts/slidy.js"]},{"type":"character","attributes":{},"value":["styles/slidy.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery-1.11.3"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["4.5.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/font-awesome-4.5.0"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/font-awesome.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["localforage"]},{"type":"character","attributes":{},"value":["1.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/localforage"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["localforage.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider"]},{"type":"character","attributes":{},"value":["2.1.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href"]}},"value":[{"type":"character","attributes":{},"value":["shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css","css/ion.rangeSlider.skinShiny.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href"]}},"value":[{"type":"character","attributes":{},"value":["shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["0.9"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["vis"]},{"type":"character","attributes":{},"value":["4.20.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/vis"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["vis.min.js"]},{"type":"character","attributes":{},"value":["vis.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["visNetwork"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["visNetwork-binding"]},{"type":"character","attributes":{},"value":["2.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["visNetwork.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["visNetwork"]},{"type":"logical","attributes":{},"value":[false]}]}]}
</script>
<!--/html_preserve-->
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
